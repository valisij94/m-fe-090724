## Практическое занятие №20

### Тема: Работа с асинхронными операциями в JS.

Репозитарий содержит материалы по практическому занятию №22, посвященному работе с сетевыми запросами, и параллельному выполнению промисов в JS.

### Цели занятия
- закрепление знаний, полученных на лекциях;
- практическое применение знаний, полученных на лекциях.

### Разогрев
1. Что выведет код?
```
const promise1 = new Promise( resolve => {
  console.log('First');
  setTimeout( () => {
    resolve('Hello')
  }, 500)
});

console.log('Start');
promise1.finally( () => console.log('Finally')).then( res => console.log(res));
console.log('Finish');
```

2. Что выведет код?
```
const promise1 = new Promise( resolve => {
  console.log('First');
  setTimeout( () => {
    console.log('Second');
    resolve('Hello')
    console.log('Third');
  }, 500)
});

console.log('Start');
promise1.then( res => console.log(res));
console.log('Finish');
```

3. Что выведет код?
```
const promise1 = new Promise( resolve => resolve('Hello')  );
const promise2 = new Promise( resolve => resolve('World') );
console.log('First');
let result = Promise.all([promise1, promise2])
  .then(res => console.log(res.join(' ')));
console.log('Second');
```

4. Что выведет код?
```
const promise1 = new Promise( resolve => { console.log('One'); resolve('Hello'); } );
const promise2 = new Promise( resolve => { console.log('Two'); resolve('World'); } );
console.log('First');
let result = Promise.all([promise1, promise2]).then(res => console.log(res.join(' ' )));
console.log('Second');
```

### Задачи занятия
1. Пристрелочная. Создать 2 промиса. Первый должен быть зарезолвлен через 1 секунду числом 10, второй - через 2 секунды, числом 15. И нужно вывести сумму результатов этих двух промисов - т.е. дождаться выполнения, и вывести в консоль.
2. Пишем функцию `makeRacer`. Она будет нам создавать объект-гонщика, который будет участвовать в заезде. Функция будет принимать объект с двумя свойствами: имя гонщика, и название машины. Задача - вернуть промис, который будет зарезолвлен спустя случайное количество секунд объектом с данными гонщика. Для вычисления времени, воспользуйтесь формулой `Math.random() * 2000`.
3. Пишем асинхронную функцию `startTraining`. Она должна принять в аргументах массив гонщиков (`racers`), пройтись по массиву, и запустить заезд для каждого гонщика. Нужно дождаться, пока все доберутся до фииниша, и вывести гонщиков в порядке прихода к финишу (например, "1 - Daniel Morales, Peugeot 308").
4. Пишем асинхронную функцию `startRace`. Теперь нас интересует тот гонщик, который первым доберется до финиша. Нужно, чтобы функция возвращала объект с данными этого гонщика. Все остальные нас не интересуют.
5. Пишем асинхронную функцию `getCategories`, которая запросит список категорий товаров с бэка, по адресу `https://dummyjson.com/products/categories`. Используем синтаксис async/await. Нужно чтобы функция вернула список категорий.
6. Пишем асинхронную функцию `getProductsByCategory`. Она должна принять в аргументах наименование категории, и запросить товары по адресу `https://dummyjson.com/products/CATEGORY`. Если категория не задана - то запрашивать все продукты по адресу `https://dummyjson.com/products`. Функция также должна вернуть массив товаров.
7. Немного отвлечемся от промисов, и вспомним DOM. Напишем функции `showLoader`, `hideLoader` для показа и скрытия иконки загрузки. Они должны показывать и скрывать параграф с текстом `Please, wait`. Параграф можно разместить в разметке, перед контейнером товаров.
8. Теперь объединяем все вместе. У нас есть функции `renderCategories`, `renderProducts` для отрисовки списка категорий и списка товаров. Также есть функции `showLoader`, `hideLoader` для показа и скрытия иконки загрузки. Нужно на момент загрузки скрипта, запросить категории и товары. Перед этим - показать иконку загрузки. Когда выполнятся оба запроса - убрать иконку. Если кто-то из запросов свалится с ошибкой - воспользуемся функцией `showError`, чтобы показать текст ошибки.
9. Делаем форму добавления товаров. Саму форму добавим в разметке. Форма должна содержать текстовое поле для названия, выпадающий список для категории, текстовое поле для цены, и текстовое поле для описания. При отправке формы, нужно отправлять запрос на бэк. Описание [здесь](https://dummyjson.com/docs/products#products-add). Рекомендуется использовать синтаксис `async/await`.

### Полезные ссылки
 - Русскоязычный гайд [async/await](https://learn.javascript.ru/async-await).
 - [Раздел про промисы](https://learn.javascript.ru/promise-api) - это раздел учебника, посвященный промисам. Также настоятельно рекомендуется к прочтению - по этой теме стопроцентно будут вопросы на собеседованиях.